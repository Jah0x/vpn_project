# Установка zerologsvpn.com

Этот документ описывает процесс автоматической установки VPN-сайта на домен `zerologsvpn.com`.

## Подготовка

1. Убедитесь, что сервер использует Ubuntu 22.04+ и имеет права `sudo`.
2. Выполните скрипт `scripts/install.sh`:

```bash
sudo bash scripts/install.sh
```

Скрипт выполнит:
- клонирование репозитория в `/opt/vpn_project`;
- установку Docker, docker-compose, nginx, certbot, Node.js 20, pnpm и PostgreSQL;
- создание файла `.env` с сгенерированными секретами;
- сборку и запуск контейнеров (`docker compose up --build`);
- настройку nginx для доменов `zerologsvpn.com` и `tg.zerologsvpn.com` (основной домен используется для логина по паролю, поддомен — для входа через Telegram);
- запрос SSL‑сертификата через `certbot` и подключение его к контейнеру;
- добавление cron‑задачи на автоматическое продление сертификата и перезагрузку nginx;
- автоматическую сборку фронтенда (`pnpm run build`) с размещением файлов в `dist/main`;
- каталог `dist/main` монтируется в контейнер nginx и используется для отдачи статики без проксирования.

## Обновление

Для последующего обновления используйте скрипт `scripts/update_zerologsvpn.sh`:

```bash
sudo bash scripts/update_zerologsvpn.sh
```

Он подтянет последние изменения из репозитория, соберёт фронтенд, пересоберёт образы и перезапустит сервисы, а также обновит сертификаты.
Вывод скрипта сохраняется в каталоге `logs/` (например, `logs/update_$(date +%F).log`).
